# tofl-gpt-parser

## Запуск сервера

Запуск осуществляется одним из двух способов:

1. Если на ПК установлен **Rust**, то с помощью команды:
   ```bash
   run --package tofl-gpt-parser --bin tofl-gpt-parser
   ```
2. Если установлен **Docker**, то с помощью команды:
   ```bash
   docker run -dp 127.0.0.1:8090:8090 parser
   ```

После запуска веб-сервер слушает на **8090 порту**.

Доступно два пути:

1. `GET /` — веб-страница для отладки.
2. `POST /parse` — сам парсер, данные передаются через **JSON**.

Для взаимодействия с парсером был развернут удаленный сервер, который доступен по следующему IP-адресу:

`http://84.201.165.255:8090/`
### Пример входных данных:

```json
{
  "TRS": "variables = x,y\nF(x) = G(y)",
  "Interpretation": "F(x) = x\nG(y) = 2*y\n"
}
```

### Пример выходных данных:

```json
{
  "json_TRS": [
    {
      "left": {
        "value": "F",
        "childs": [
          {
            "value": "x",
            "childs": []
          }
        ]
      },
      "right": {
        "value": "G",
        "childs": [
          {
            "value": "y",
            "childs": []
          }
        ]
      }
    }
  ],
  "json_interpret": {
    "functions": [
      {
        "name": "F",
        "variables": ["x"],
        "expression": "(x)"
      },
      {
        "name": "G",
        "variables": ["y"],
        "expression": "(2 * y)"
      }
    ]
  }
}
```

### Форматирование ошибок:

Парсер предусматривает обработку большого числа ошибок. Для обработки несущественных ошибок (напр. несоответствие грамматике, которое можно корректно обработать и продолжить парсинг)

Несколько примеров формата ошибок:
```json
{
  "error_trs": [
    "Ошибка в строке 1, на позиции 5, ожидалось b, считано ' '"
  ]
}
```

```json
   variables = x
   f(g(h(i(j(k(l(m(n(o(p(x))))))))))) = q(x)
   f(a,b) = c

{
  "error_trs": [
    "Не совпадает арность функции f, ожидаемое количество аргументов: 2 , считано: 1"
  ]
}
```

В примерах ниже неблокирующие ошибки аккумулируются до тех пор, пока не встретится ошибка приводящая к завершению парсинга с ошибкой.
```json
variables x, x, y
f(x = f(x)


{
  "error_trs": [
    "Ошибка в строке 1, на позиции 10. Не хватает '=' в списке переменных",
    "Переменная x объявлена несколько раз"
    "Ошибка в строке 2, на позиции 4, ожидалось ), считано '='"
  ]
}
```

```json
TRS:
variables = x
f(x, y) = g(x)

Interpretation:
f(x, x, z) = 2

Result:
{
  "error_interpretation": [
    "Ошибка в строке 1, на позиции 6. Переменная x уже была указана в числе аргументов данной функции",
    "Ошибка в строке 1, на позиции 10. Количество переменных в интерпретации функции f не совпадает с количеством переменных в TRS",
    "Функция g была объявлена в TRS, но её нет в интерпретации",
    "Константа y была объявлена в TRS, но её нет в интерпретации"
  ]
}
```